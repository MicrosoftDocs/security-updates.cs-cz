---
TOCTitle: 'MS07-018'
Title: 'Microsoft Security Bulletin MS07-018 - Kritické'
ms:assetid: 'ms07-018'
ms:contentKeyID: 61223700
ms:mtpsurl: 'https://technet.microsoft.com/cs-CZ/library/ms07-018(v=Security.10)'
---

Security Bulletin

Microsoft Security Bulletin MS07-018 - Kritické
===============================================

Chyby zabezpečení v serveru Microsoft Content Management Server umožňují vzdálené spuštění kódu (925939)
--------------------------------------------------------------------------------------------------------

Publikováno: 10. dubna 2007 | Aktualizováno: 12. června 2007

**Verze:** 2.0

#### Shrnutí

**Komu je tento dokument určen:** Zákazníkům, kteří používají server Microsoft Content Management Server

**Dopad této chyby zabezpečení:** Vzdálené spuštění kódu

**Stupeň maximální závažnosti:** Kritický

**Doporučení:** Zákazníci by měli tuto aktualizaci nainstalovat okamžitě.

**Nahrazené aktualizace zabezpečení:** Žádný

**Upozornění:** [Článek 924429 znalostní báze Microsoft Knowledge Base](http://support.microsoft.com/kb/924429) popisuje aktuálně známé problémy, s nimiž se mohou zákazníci setkat v případě instalace této aktualizace zabezpečení. V článku jsou také uvedena doporučená řešení těchto problémů. Další informace získáte v [článku 924429 znalostní báze Microsoft Knowledge Base](http://support.microsoft.com/kb/924429).

**Testovaný software a umístění pro stahování aktualizace zabezpečení:**

**Software obsahující tuto chybu:**

-   Microsoft Content Management Server 2001 Service Pack 1 – [stáhnout aktualizaci (KB924430)](http://www.microsoft.com/downloads/details.aspx?familyid=0aac923d-a6b8-4023-9977-aea6782dc1c7)
-   Microsoft Content Management Server 2002 Service Pack 2 – [stáhnout aktualizaci (KB924429)](http://www.microsoft.com/downloads/details.aspx?familyid=41d53931-bcf8-43d9-9d16-592ebfb0ac04)

Uvedený software byl testován, zda neobsahuje tuto chybu. Pro ostatní verze buď již nejsou poskytovány opravy zabezpečení, nebo tuto chybu neobsahují. Pokud chcete zjistit dobu, po kterou je pro určitý produkt a verzi poskytována technická podpora, navštivte web [Zásady poskytování technické podpory pro produkty společnosti Microsoft](http://go.microsoft.com/fwlink/?linkid=21742).

### Obecné informace

Shrnutí
-------


**Shrnutí:**

Tato aktualizace umožňuje odstranit dvě nově zjištěné chyby zabezpečení oznámené soukromými osobami. Obě chyby jsou popsány v tomto bulletinu v části Podrobné informace o chybě zabezpečení.

Doporučujeme zákazníkům okamžitou instalaci této aktualizace.

**Stupeň závažnosti a identifikátory chyb zabezpečení:**

| Identifikátory chyb zabezpečení                                                                                                                                                  | Dopad této chyby zabezpečení                     | Microsoft Content Management Server 2001 Service Pack 1 | Microsoft Content Management Server 2002 Service Pack 2 |
|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------------------|---------------------------------------------------------|---------------------------------------------------------|
| Chyba zabezpečení týkající se poškození paměti serveru CMS – [CVE-2007-0938](http://cve.mitre.org/cgi-bin/cvename.cgi?name=cve-2007-0938)                                        | Vzdálené spuštění kódu                           | Kritický                                                | Kritický                                                |
| Chyba zabezpečení umožňující skriptování mezi servery a umísťování falešného obsahu u serveru CMS – [CVE-2007-0939](http://cve.mitre.org/cgi-bin/cvename.cgi?name=cve-2007-0939) | Přístup k informacím a vkládání falešného obsahu | Vysoký                                                  | Vysoký                                                  |
| **Celkový stupeň závažnosti všech chyb zabezpečení**                                                                                                                             |                                                  | **Kritický**                                            | **Kritický**                                            |

Výše uvedené [hodnocení](http://go.microsoft.com/fwlink/?linkid=21140) je založeno na typech systémů, které jsou touto chybou postiženy, jejich typických instalacích a dopadu, který by na ně zneužití této chyby mělo.

Nejčastější dotazy související s touto aktualizací zabezpečení
--------------------------------------------------------------


**Proč společnost Microsoft 12. června 2007 znovu vydala tento bulletin?**  
Tento bulletin byl znovu vydán, aby obsahoval informace o odstranění chyb, které byly popsány v [článku 924429 znalostní báze Microsoft Knowledge Base](http://support.microsoft.com/kb/924429). Předchozí aktualizace zabezpečení nevyřešila problém instalace serveru CMS 2002 v jiném umístění, než je výchozí umístění cesty. Zákazníci, kteří nainstalovali původní verzi aktualizace zabezpečení, se musí pro obnovení normální funkčnosti řídit postupem uvedeným v [článku 924429 znalostní báze Microsoft Knowledge Base](http://support.microsoft.com/kb/924429).

**Které aktualizace tato verze nahrazuje?**  
Tato aktualizace nenahrazuje předcházející aktualizaci zabezpečení. Pokud používáte Content Management Server 2001, doporučujeme nainstalovat před touto aktualizací opravu MS03-002.

**Je možné určit pomocí nástroje MBSA (Microsoft Baseline Security Analyzer), zda je tato aktualizace nezbytná?**  
Následující tabulka uvádí shrnutí týkající se zjišťování pomocí nástroje MBSA pro tuto aktualizaci zabezpečení.

| Produkt                                                 | MBSA 1.2.1 | MBSA 2.0.1 |
|---------------------------------------------------------|------------|------------|
| Microsoft Content Management Server 2001 Service Pack 1 | Ano        | Ne         |
| Microsoft Content Management Server 2002 Service Pack 2 | Ano        | Ano        |

**Poznámka:** Nástroj MBSA 1.2.1 používá integrovanou verzi nástroje pro rozpoznávání sady Office, který nepodporuje vzdálené vyhledávání této aktualizace zabezpečení. Další informace o nástroji MBSA získáte na [webu nástroje MBSA](http://go.microsoft.com/fwlink/?linkid=21134).

Další informace o nástroji MBSA získáte na [webu nástroje MBSA](http://go.microsoft.com/fwlink/?linkid=21134). Další informace o programech, které web Microsoft Update a nástroj MBSA 2.0.1 v současné době nerozpoznává, získáte v [článku 895660 znalostní báze Microsoft Knowledge Base](http://support.microsoft.com/kb/895660).

Podrobnější informace získáte v [článku 910723 znalostní báze Microsoft Knowledge Base](http://support.microsoft.com/kb/910723): Přehled článků na daný měsíc týkajících se doporučených postupů zjišťování a instalace.

**Je možné určit pomocí serveru Systems Management Server (SMS), zda je tato aktualizace nezbytná?**  
Následující tabulka uvádí shrnutí týkající se zjišťování pomocí serveru SMS pro tuto aktualizaci zabezpečení.

| Produkt                                                 | SMS 2.0 | SMS 2003 |
|---------------------------------------------------------|---------|----------|
| Microsoft Content Management Server 2001 Service Pack 1 | Ano     | Ne       |
| Microsoft Content Management Server 2002 Service Pack 2 | Ano     | Ano      |

Server SMS 2.0 a sada SMS 2003 Software Update Services (SUS) Feature Pack mohou ke zjišťování používat nástroj MBSA 1.2.1, a proto se na ně vztahují omezení uvedená v předchozí části tohoto bulletinu týkající se programů, které není možné zjistit pomocí nástroje MBSA 1.2.1.

U serveru SMS 2.0 lze sadu SMS SUS Feature Pack obsahující nástroj SUIT (Security Update Inventory Tool) používat serverem SMS ke zjištění aktualizací zabezpečení. Sada SMS SUIT využívá k zjišťování modul MBSA 1.2.1. Další informace o protokolu SUIT naleznete na následujícím [webu společnosti Microsoft](http://support.microsoft.com/kb/894154/). Další informace o omezeních nástroje SUIT získáte v [článku 306460 znalostní báze Microsoft Knowledge Base](http://support.microsoft.com/kb/306460/). Sada SMS SUS Feature Pack obsahuje také nástroj Microsoft Office Inventory Tool umožňující rozpoznávání aplikací sady Microsoft Office.

U serveru SMS 2003 lze nástroj SMS 2003 ITMU (Inventory Tool for Microsoft Updates) používat serverem SMS ke zjištění aktualizací zabezpečení nabízených webem [Microsoft Update](http://update.microsoft.com/microsoftupdate) a podporovaných službou [Windows Server Update Services](http://go.microsoft.com/fwlink/?linkid=50120). Další informace o nástroji SMS 2003 ITMU naleznete na následujícím [webu společnosti Microsoft](http://go.microsoft.com/fwlink/?linkid=72181). Server SMS 2003 může zjišťovat požadované aktualizace aplikací sady Microsoft Office také pomocí nástroje Microsoft Office Inventory Tool.

Další informace o nástroji SMS získáte na webu [nástroje SMS](http://go.microsoft.com/fwlink/?linkid=21158).

Podrobnější informace získáte v [článku 910723 znalostní báze Microsoft Knowledge Base](http://support.microsoft.com/kb/910723): Přehled článků na daný měsíc týkajících se doporučených postupů zjišťování a instalace.

Podrobné informace o chybě zabezpečení
--------------------------------------


#### Chyba zabezpečení týkající se poškození paměti serveru CMS – CVE-2007-0938:

V serveru Content Management Server existuje chyba zabezpečení umožňující vzdálené spuštění kódu. Důvodem je způsob zpracování speciálně vytvořeného požadavku HTTP.

Útočník, který by tuto chybu zabezpečení zneužil, by mohl získat úplnou kontrolu nad postiženým systémem. Útočník by tak mohl instalovat programy, zobrazovat, měnit či odstraňovat data nebo vytvářet nové účty s úplnými uživatelskými právy.

#### Skutečnosti snižující závažnost rizika spojeného s chybou zabezpečení týkající se poškození paměti serveru CMS – CVE-2007-0938:

-   Pracovní proces W3WP.exe ve službě Microsoft Internet Information Service 6.0 představuje ve výchozím nastavením proces s nízkou úrovní oprávnění spuštěný jako předdefinovaný účet síťové služby.  
    **Poznámka:** Týká se pouze serveru Content Management Server 2002.
-   Zákazníci, kteří nakonfigurovali weby serveru MCMS (Microsoft Content Management Server) ve vlastních fondech aplikací a izolovali je tak od ostatních webů, mohou tímto způsobem snížit dopad útoku.

#### Zástupná řešení chyby zabezpečení týkající se poškození paměti serveru CMS – CVE-2007-0938:

Zatím nebylo nalezeno žádné zástupné řešení této chyby zabezpečení.

#### Nejčastější dotazy týkající se chyby zabezpečení způsobující poškození paměti serveru CMS – CVE-2007-0938:

**Jaký je rozsah této chyby zabezpečení?**  
V serveru Content Management Server existuje chyba zabezpečení umožňující vzdálené spuštění kódu. Důvodem je způsob zpracování speciálně vytvořeného požadavku HTTP. Útočník, který by tuto chybu zabezpečení úspěšně zneužil, by mohl vzdáleně získat úplnou kontrolu nad postiženým systémem. Útočník by tak mohl instalovat programy, zobrazovat, měnit či odstraňovat data nebo vytvářet nové účty s úplnými uživatelskými právy.

**Co tuto chybu zabezpečení způsobuje?**  
Příčinou chyby zabezpečení umožňující vzdálené spuštění kódu je způsob, jakým server Microsoft Content Management Server zpracovává neočekávané znaky v požadavku HTTP.

**Co je Microsoft Content Management Server?**  
[Microsoft Content Management Server](http://www.microsoft.com/cmserver/default.mspx) (MCMS) pomáhá zákazníkům vytvářet, nasazovat a udržovat webové stránky. Pomocí serveru MCMS mohou zákazníci tvořit, publikovat a spravovat webový obsah a také spravovat serverové prostředky dostupné pro daný web.

**Používám server Microsoft Content Management Server 2001 a přizpůsobený soubor ManualLogin.asp. Je třeba něco udělat?**  
Tato aktualizace se stránky ManualLogin.asp netýká. Jakékoli vlastní úpravy uvedené stránky proto zůstanou zachovány i po instalaci této aktualizace. Přesto však doporučujeme zálohovat přizpůsobené stránky ASP před údržbou každého webu.

**K čemu by mohl útočník tuto chybu zabezpečení zneužít?**  
Útočník, který by tuto chybu zabezpečení zneužil, může získat úplnou kontrolu nad ohroženým systémem.

**Jak by mohl útočník tuto chybu zabezpečení zneužít?**  
Útočník by se mohl pokusit tuto chybu zabezpečení zneužít sestavením speciálně vytvořené adresy URL a odesláním požadavku HTTP GET do systému CMS (Content Management System).

**Které systémy jsou touto chybou ohroženy nejvíce?**  
Weby udržované pomocí verzí serveru Microsoft Content Management Server obsahujících tuto chybu.

**Co je podstatou této aktualizace?**  
Tato aktualizace odstraňuje uvedenou chybu zabezpečení změnou způsobu, jakým Content Management Server ověřuje požadavek HTTP.

**Byla v době zveřejnění tohoto bulletinu tato chyba zabezpečení veřejně známá?**  
Ne. Společnost Microsoft byla o této chybě informována důvěryhodným zdrojem. Společnost Microsoft nemá žádné informace, které by naznačovaly, že tato chyba zabezpečení byla v době vydání tohoto bulletinu veřejně známá.

**Měla v době zveřejnění tohoto bulletinu společnost Microsoft nějaké informace o tom, že tato chyba zabezpečení byla zneužita?**  
Ne. Společnost Microsoft neměla žádné informace, které by naznačovaly, že daná chyba zabezpečení byla v době původního zveřejnění tohoto bulletinu zneužita k útoku na zákazníky, a nezaznamenala ani žádné důkazy nebo publikované příklady kódu, které by naznačovaly, že tato chyba byla zneužita.

#### Chyba zabezpečení umožňující skriptování mezi servery a umísťování falešného obsahu u serveru CMS – CVE-2007-0939:

U serveru MCMS (Microsoft Content Management Server) existuje chyba zabezpečení umožňující skriptování mezi servery a umísťování falešného obsahu, díky níž by mohl útočník uživatele přesvědčit, aby spustil škodlivý skript. Tento škodlivý skript by byl spuštěn v kontextu zabezpečení daného uživatele. Při pokusech o zneužití této chyby zabezpečení je nutná interakce s uživatelem. Při zneužití této chyby by útočník mohl získat přístup k libovolným datům v ohrožených systémech, ke kterým má daný uživatel přístup.

Tuto chybu lze také zneužít k provedení změn v mezipaměti webového prohlížeče a zprostředkujícího serveru proxy a k umístění falešného obsahu do těchto mezipamětí.

#### Skutečnosti snižující závažnost rizika spojeného s chybou zabezpečení umožňující skriptování mezi servery a umísťování falešného obsahu u serveru CMS – CVE-2007-0939:

-   Tuto chybu zabezpečení by nemělo být možné automaticky zneužít pomocí e-mailu. Aby byl útok úspěšný, musí uživatel klepnout na webový odkaz, který je odeslán v e-mailové zprávě.
-   Útok může být úspěšný pouze v případě, že uživatel, který byl přesvědčen, aby klepl na útočníkem speciálně vytvořenou adresu URL, měl přístup k webovému serveru CMS.
-   Útočník, který by tuto chybu zabezpečení úspěšně zneužil k útoku prostřednictvím skriptování mezi servery, by získal pouze taková oprávnění, jaká má daný uživatel.
-   Uživatelům, kteří v aplikaci Internet Explorer zapnuli možnost Neukládat šifrované stránky na disk, nehrozí nebezpečí umístění falešného obsahu do mezipaměti prohlížeče, pokud k webu získávají přístup prostřednictvím protokolu Secure Sockets Layer (SSL).
-   Uživatelům, kteří k ohroženým webům získávají přístup prostřednictvím připojení chráněných protokolem SSL, nehrozí nebezpečí umístění falešného obsahu do mezipaměti zprostředkujícího serveru proxy. Je tomu tak proto, že data relací protokolu SSL jsou šifrována a do mezipamětí zprostředkujících serverů proxy se neukládají.
-   Pokud by byl do mezipaměti zprostředkujícího serveru proxy falešný obsah úspěšně umístěn, bylo by pro útočníka těžké předpovědět, kterému uživateli by byl takový falešný obsah z mezipaměti doručen.

#### Zástupná řešení chyby zabezpečení umožňující skriptování mezi servery a umísťování falešného obsahu u serveru CMS – CVE-2007-0939:

Společnost Microsoft testovala následující zástupná řešení. Přestože tato zástupná řešení neopravují samotnou chybu zabezpečení, pomáhají blokovat známé způsoby útoku. Případná omezení funkčnosti způsobená daným zástupným řešením jsou uvedena v následující části.

-   **Nastavení webové stránky serveru MCMS do režimu Pouze pro čtení znemožní vytváření obsahu a přístup ke vstupnímu bodu serveru MCMS z prostředí Správce webu**  

    Nastavení možnosti **Yes – Read Only** (Ano – pouze pro čtení) u webové stránky serveru MCMS znemožní vytváření obsahu a přístup ke vstupnímu bodu serveru MCMS ze Správce webu, ale neodebere žádné soubory ze systému souborů. Pokud chcete nástroj Správce souborů použít ke změně nastavení webové stránky serveru MCMS do režimu Pouze pro čtení, je nutné nejprve stránku nastavit pro čtení a zápis v nástroji pro konfiguraci webového serveru.
    Po nastavení webové stránky serveru MCMS do režimu Pouze pro čtení nebude možné k nasazení obsahu webu použít funkci SDAPI na straně klienta. Na webu v režimu Pouze pro čtení je pro rozhraní API nasazení obsahu nutné použít funkci SDAPI na straně serveru, pokud nemáte samostatný vstupní bod na web pro čtení a zápis.

    **Chcete-li upravit webovou stránku serveru MCMS do režimu Pouze pro čtení, postupujte podle následujících pokynů:**

    1.  Klepněte na tlačítko **Start**, klepněte na příkaz **Programy** a poté vyberte položku **Microsoft Content Management Server**.
    2.  Klepněte na možnost **Server Configuration Application** (Aplikace konfigurace serveru).
    3.  Klepněte na kartu **Web** a vyberte možnost **Configure** (Konfigurovat).
    4.  V dialogovém okně pro web serveru MCMS, který chcete nakonfigurovat, vyberte možnost **Yes – Read Only** (Ano – pouze pro čtení).
    5.  Klepnutím na tlačítko **OK** uložte změny.

    **Dopad tohoto zástupného řešení:** Uživatelé již nebudou mít možnost vytvářet obsah prostřednictvím nástroje Web Author serveru MCMS (k serveru MCMS není možné přihlášení s oprávněními k úpravám), ani pomocí Správce serveru.

#### Nejčastější dotazy týkající se chyby zabezpečení umožňující skriptování mezi servery a umísťování falešného obsahu u serveru Microsoft Content Management Server – CVE-2007-0939:

**Jaký je rozsah této chyby zabezpečení?**  
U serveru MCMS (Microsoft Content Management Server) existuje chyba zabezpečení umožňující skriptování mezi servery a umísťování falešného obsahu. Tato chyba zabezpečení by mohla povolit vkládání skriptů na straně klienta do prohlížeče uživatele. V případě útoku z webu by ohrožený web mohl přijmout nebo být hostitelem materiálů poskytovaných uživateli a reklamy, která by mohla obsahovat speciálně vytvořené položky zneužívající tuto chybu zabezpečení.

Tento skript by mohl jménem uživatele provést jakoukoli akci, kterou může web provádět. Mohlo by se jednat o sledování webové relace a předávání informací třetí straně, spuštění dalšího kódu v systému uživatele a čtení nebo zapisování souborů cookie.

**Co tuto chybu zabezpečení způsobuje?**  
Chybu zabezpečení umožňující skriptování mezi servery (XSS) způsobuje Microsoft Content Management Server, který nedostatečně ověřuje vstupní údaje uvedené v dotazu na přesměrování HTML, než tyto vstupní údaje odešle prohlížeči.

**Co je Microsoft Content Management Server?**  
[Microsoft Content Management Server](http://www.microsoft.com/cmserver/default.mspx) (MCMS) pomáhá zákazníkům vytvářet, nasazovat a udržovat webové stránky. Pomocí serveru MCMS mohou zákazníci tvořit, publikovat a spravovat webový obsah a také spravovat serverové prostředky dostupné pro daný web.

**Co je skriptování mezi servery?**  
Skriptování mezi servery (XSS) je třída chyb zabezpečení, které by mohly umožnit útočníkovi, aby dopravil kód skriptu do relace uživatele s webem. Tato chyba může ovlivnit webové servery, které dynamicky generují stránky HTML. Pokud tyto servery obsahují vstup z prohlížeče v dynamických stránkách odesílaných zpět prohlížeči, lze tyto servery manipulovat tak, aby zahrnovaly škodlivý obsah dynamických stránek. To může umožnit spuštění škodlivého skriptu. Tento problém přetrvává také díky předpokladu webových prohlížečů o důvěryhodnosti webů a používání souborů cookie k usnadnění práce s navštěvovanými weby. Útok typu XSS nemění obsah webu. Místo toho se využívá vkládání nového, škodlivého skriptu, který se může spustit v prohlížeči v kontextu spojeném s důvěryhodným serverem.

**Jak skriptování mezi servery funguje?**  
Webové stránky obsahují text a značky HTML. Text a značky HTML jsou generovány serverem a klient je interpretuje. Pokud je na dynamickou stránku vložen nedůvěryhodný obsah, nemá ani server ani klient dostatečné informace ke zjištění, zda k tomuto vložení došlo a zda je třeba přijmout ochranná opatření.

**Používám server Microsoft Content Management Server 2001 a přizpůsobený soubor ManualLogin.asp. Je třeba něco udělat?**  
Tato aktualizace se stránky ManualLogin.asp netýká. Jakékoli vlastní úpravy uvedené stránky proto zůstanou zachovány i po instalaci této aktualizace. Přesto však doporučujeme zálohovat přizpůsobené stránky ASP před údržbou každého webu.

**K čemu by mohl útočník tuto chybu zabezpečení zneužít?**  
Útočník, který úspěšně zneužije tuto chybu zabezpečení, může dopravit skript na straně klienta do prohlížeče uživatele. Skript může umístit falešný obsah, zpřístupnit informace nebo provést akci, kterou je uživatel přesměrován na postižený web. Při pokusech o zneužití této chyby zabezpečení je nutná interakce s uživatelem. Tuto chybu lze také zneužít k provedení změn v mezipaměti webového prohlížeče a zprostředkujícího serveru proxy a k umístění falešného obsahu do těchto mezipamětí.

**Jak by mohl útočník tuto chybu zabezpečení zneužít?**  
V případě útoku prostřednictvím e-mailu by útočník mohl tuto chybu zabezpečení zneužít odesláním speciálně vytvořené e-mailové zprávy uživateli serveru, na kterém je spuštěna postižená softwarová aplikace. Útočník by potom mohl uživatele přesvědčit, aby klepnul na odkaz v této e-mailové zprávě.

V případě útoku z webu by útočník mohl dopravit skript na straně klienta do prohlížeče uživatele. Skript může umístit falešný obsah, zpřístupnit informace nebo provést akci, kterou je uživatel přesměrován na postižený web. Při pokusech o zneužití této chyby zabezpečení je nutná interakce s uživatelem.

Tuto chybu lze také zneužít k provedení změn v mezipaměti webového prohlížeče a zprostředkujícího serveru proxy a k umístění falešného obsahu do těchto mezipamětí.

**Které systémy jsou touto chybou ohroženy nejvíce?**  
Weby udržované pomocí verzí serveru Microsoft Content Management Server obsahujících tuto chybu.

**Bylo by možné tuto chybu zabezpečení zneužít prostřednictvím Internetu?**  
Ano. Útočník by se mohl pokusit o zneužití této chyby zabezpečení prostřednictvím Internetu. Musel by znát celý název serveru CMS, aby jej mohl napadnout.

**Co je podstatou této aktualizace?**  
Tato aktualizace odstraňuje uvedenou chybu změnou způsobu, jakým Content Management Server ověřuje dotazy na přesměrování HTTP.

**Byla v době zveřejnění tohoto bulletinu tato chyba zabezpečení veřejně známá?**  
Ne. Společnost Microsoft byla o této chybě informována důvěryhodným zdrojem. Společnost Microsoft nemá žádné informace, které by naznačovaly, že tato chyba zabezpečení byla v době vydání tohoto bulletinu veřejně známá. Tento bulletin zabezpečení odstraňuje chybu zabezpečení oznámenou soukromou osobou společně s dalšími problémy zjištěnými interním šetřením.

**Měla v době zveřejnění tohoto bulletinu společnost Microsoft nějaké informace o tom, že tato chyba zabezpečení byla zneužita?**  
Ne. Společnost Microsoft neměla žádné informace, které by naznačovaly, že daná chyba zabezpečení byla v době původního zveřejnění tohoto bulletinu zneužita k útoku na zákazníky, a nezaznamenala ani žádné důkazy nebo publikované příklady kódu, které by naznačovaly, že tato chyba byla zneužita.

Informace o této aktualizaci zabezpečení
----------------------------------------


**Software obsahující tuto chybu:**

Informace o konkrétní aktualizaci zabezpečení pro software obsahující tuto chybu získáte v příslušné části:

#### Content Management Server

#### Požadavky a další podrobnosti o této aktualizaci

**Důležité:** Před instalací této aktualizace se přesvědčte, zda jsou splněny následující požadavky:

-   Chcete-li nainstalovat Content Management Server 2001, musí být nainstalována aktualizace Service Pack 1. Před instalací této aktualizace nainstalujte aktualizaci [Content Management Server 2001 Service Pack 1](http://www.microsoft.com/downloads/details.aspx?familyid=bf03c4cd-17b1-4a6f-8ded-e401909b4791).
-   Chcete-li nainstalovat Content Management Server 2002, musí být nainstalována aktualizace Service Pack 2. Před instalací této aktualizace nainstalujte aktualizaci [Content Management Server 2002 Service Pack 2](http://www.microsoft.com/downloads/details.aspx?familyid=3de1e8f0-d660-4a2b-8b14-0fce961e56fb).
-   Uživatelům serveru Content Management Server 2001 Service Pack 1 doporučujeme nainstalovat před touto aktualizací opravu [MS03-002](http://technet.microsoft.com/security/bulletin/ms03-002).

**Zahrnutí do budoucích aktualizací Service Pack**

Pro server Content Management Server 2001 a Content Management Server 2002 se do budoucna neplánují žádné aktualizace Service Pack. Poslední aktualizací tak je Service Pack 2.

**Požadavek na restartování**

Pokud nechcete počítač restartovat, před instalací aktualizace zabezpečení zastavte všechny služby obsahující uvedenou chybu a ukončete všechny aplikace, které by mohly používat soubory obsahující uvedenou chybu. Další informace o důvodech, které mohou způsobit zobrazení výzvy k restartování počítače, najdete v [článku 887012 znalostní báze Microsoft Knowledge Base](http://support.microsoft.com/kb/887012).

**Informace o odinstalaci**

Po instalaci nelze tuto aktualizaci odebrat. Pokud byste chtěli obnovit systém do stavu před instalací této aktualizace, bude nutné tuto aplikaci odebrat a potom ji znovu nainstalovat z původního disku CD-ROM.

#### Informace o automatické instalaci

**Web Microsoft Update**

Tato aktualizace bude k dispozici prostřednictvím [webu Microsoft Update](http://update.microsoft.com/microsoftupdate). Web Microsoft Update spojuje aktualizace poskytované webem Windows Update a webem Office Update do jednoho umístění a umožňuje vybrat automatické poskytnutí a instalaci nejdůležitějších aktualizací a aktualizací zabezpečení. Doporučujeme nainstalovat tuto aktualizaci prostřednictvím webu Microsoft Update. Web Microsoft Update zjistí vaši konkrétní instalaci a vyzve vás k instalaci přesně těch součástí, které jsou nezbytné pro zajištění nejaktuálnější verze instalace.

Chcete-li prostřednictvím webu Microsoft Update zjistit požadované aktualizace, které je třeba do počítače nainstalovat, přejděte na web Microsoft Update. Budete si moci vybrat možnost **Expresní (doporučeno)** nebo **Vlastní.** Po dokončení zjišťování se zobrazí seznam doporučených aktualizací ke schválení. Klepnutím na položku **Instalovat aktualizace** nebo **Zkontrolovat a instalovat aktualizace** proces dokončete.

#### Informace o instalaci

Pokud jste aplikaci nainstalovali ze serverového umístění, musí toto umístění správce serveru aktualizovat pomocí aktualizace pro správce a instalovat tuto aktualizaci do počítače.

**Informace o instalaci**

Následující instalační přepínače lze použít při instalacích pro správce, protože správcům umožňují přizpůsobit způsob extrahování souborů v rámci aktualizace zabezpečení.

Tato aktualizace zabezpečení podporuje následující instalační přepínače pro aktualizaci Content Management Server 2001 Service Pack 1:

<caption>Podporované instalační přepínače pro aktualizaci zabezpečení
</caption>

| Přepínač | Popis                                                                                 |
|----------|---------------------------------------------------------------------------------------|
| **/q**   | Nastaví tichý režim (potlačí zobrazování dialogových oken během extrahování souborů). |

Tato aktualizace zabezpečení podporuje následující instalační přepínače pro aktualizaci Content Management Server 2002 Service Pack 1:

<caption>Podporované instalační přepínače pro aktualizaci zabezpečení
</caption>

| Přepínač     | Popis                                                                                                                   |
|--------------|-------------------------------------------------------------------------------------------------------------------------|
| **/q**       | Nastaví tichý režim (potlačí zobrazování dialogových oken během extrahování souborů).                                   |
| **/q:u**     | Nastaví tichý režim, ve kterém se uživateli zobrazují některá dialogová okna.                                           |
| **/q:a**     | Nastaví tichý režim pro správce, v němž se uživateli nezobrazují žádná dialogová okna.                                  |
| **/t:cesta** | Určuje cílovou složku pro extrahované soubory.                                                                          |
| **/c**       | Extrahuje soubory, ale nenainstaluje je. Není-li zadán přepínač **/t: cesta**, zobrazí se výzva k zadání cílové složky. |
| **/c:cesta** | Přepíše instalační příkaz definovaný autorem. Určuje cestu a název souboru INF nebo EXE instalačního programu.          |
| **/r:n**     | Po instalaci nerestartuje počítač.                                                                                      |
| **/r:I**     | Zobrazí výzvu k restartování počítače, pokud je to požadováno, kromě případů, kdy je zároveň použit přepínač **/q:a**.  |
| **/r:a**     | Po instalaci vždy restartuje počítač.                                                                                   |
| **/r:s**     | Po instalaci restartuje počítač, aniž by uživateli zobrazil výzvu.                                                      |
| **/n:v**     | Nekontroluje verzi. (Vždy nainstaluje opravu přes jakoukoli předchozí verzi.)                                           |

**Poznámka:** Tyto přepínače nemusejí být funkční se všemi aktualizacemi. Pokud přepínač není k dispozici, je daná funkce vyžadována ke správné instalaci této aktualizace. Použití přepínače **/n:v** navíc není podporováno a může způsobit, že se počítač nepodaří spustit. Pokud instalace neproběhne správně, obraťte se na pracovníka technické podpory, který vám pomůže zjistit příčinu problémů.

Další informace o podporovaných instalačních přepínačích najdete v [článku 197147 znalostní báze Microsoft Knowledge Base](http://support.microsoft.com/kb/197147).

**Informace o nasazení**

1.  Stáhněte tuto aktualizaci zabezpečení pro Content Management Server 2001 Service Pack 1 nebo Content Management Server 2002 Service Pack 2.
2.  Klepněte na položku **Uložit program na disk** a potom na tlačítko **OK**.
3.  Klepněte na tlačítko **Uložit**.
4.  V programu Průzkumník Windows přejděte do složky obsahující uložený soubor a poklepejte na něj.
5.  Zobrazí-li se výzva k instalaci aktualizace, klepněte na tlačítko **Ano**.
6.  Klepnutím na tlačítko **Ano** potvrďte souhlas s licenční smlouvou.
7.  Po zobrazení výzvy vložte původní zdrojový disk CD-ROM a klepněte na tlačítko **OK**.
8.  Po zobrazení oznámení o úspěšné instalaci klepněte na tlačítko **OK**.

**Informace o instalovaných souborech**

Anglická verze této aktualizace má následující atributy souborů. Data a časy jednotlivých souborů jsou uvedeny ve formátu UTC (Coordinated Universal Time). Při zobrazení informací o souboru jsou data a čas převedeny na místní čas. Rozdíl mezi místním časem a časem UTC naleznete na kartě **Časové pásmo** na panelu Datum a čas v okně Ovládací panely.

Content Management Server 2001 Service Pack 1:

| Název souboru              | Verze       | Datum             | Čas  | Velikost  |
|----------------------------|-------------|-------------------|------|-----------|
| Aesecurityclient.dll       | 4.10.1157.0 | 9. listopadu 2006 | 0:30 | 124 704   |
| Aesecurityservice.exe      | 4.10.1157.0 | 9. listopadu 2006 | 0:30 | 154 400   |
| Aeserverobject.dll         | 4.10.1157.0 | 9. listopadu 2006 | 0:30 | 1 157 400 |
| Ncaspextensions.dll        | 4.10.1157.0 | 9. listopadu 2006 | 0:30 | 117 536   |
| Nrmsgres.dll               | 4.10.1157.0 | 9. listopadu 2006 | 0:30 | 160 016   |
| Reauthfilt.dll             | 4.10.1157.0 | 9. listopadu 2006 | 0:30 | 50 448    |
| Resolutionobjectmodel.dll  | 4.10.1157.0 | 9. listopadu 2006 | 0:30 | 1 133 352 |
| Serverconfigurationapi.dll | 4.10.1157.0 | 9. listopadu 2006 | 0:30 | 641 320   |

Content Management Server 2002 Service Pack 2:

| Název souboru                                               | Verze      | Datum          | Čas   | Velikost  |
|-------------------------------------------------------------|------------|----------------|-------|-----------|
| Activexediting.vbs                                          |            | 30. ledna 2007 | 20:47 | 17 857    |
| Aejavaproxy.dll                                             | 5.0.4484.0 | 24. října 2003 | 10:33 | 1 994 752 |
| Aeserverobject.dll                                          | 5.0.5317.0 | 30. ledna 2007 | 21:14 | 1 193 472 |
| Authformclientie.js                                         |            | 30. ledna 2007 | 20:47 | 7 422     |
| Cms2002.xml                                                 |            | 26. února 2007 | 21:39 | 7 972     |
| Console.js                                                  |            | 30. ledna 2007 | 20:47 | 9 501     |
| Emitterthineditie\_activex.inc                              |            | 30. ledna 2007 | 23:05 | 24 371    |
| Hlink.js                                                    |            | 30. ledna 2007 | 20:47 | 5 204     |
| Microsoft.contentmanagement.common.dll                      | 5.0.5317.0 | 30. ledna 2007 | 21:13 | 57 344    |
| Microsoft.contentmanagement.developertools.visualstudio.dll | 5.0.5317.0 | 30. ledna 2007 | 21:17 | 126 976   |
| Microsoft.contentmanagement.webauthor.dll                   | 5.0.5317.0 | 30. ledna 2007 | 21:15 | 397 312   |
| Microsoft.contentmanagement.webcontrols.dll                 | 5.0.5317.0 | 30. ledna 2007 | 21:15 | 204 800   |
| Ncaspextensions.dll                                         | 5.0.5317.0 | 30. ledna 2007 | 21:13 | 164 864   |
| Ncbmprdr.dll                                                | 5.0.5317.0 | 30. ledna 2007 | 21:13 | 149 504   |
| Nrdcapplication.exe                                         | 5.0.0.5317 | 30. ledna 2007 | 21:18 | 2 240 608 |
| Nrdhtml.cab                                                 |            | 30. ledna 2007 | 21:30 | 233 743   |
| Nrsitedeployclient.dll                                      | 5.0.5317.0 | 30. ledna 2007 | 21:15 | 588 800   |
| Nrsitedeployserver.dll                                      | 5.0.5317.0 | 30. ledna 2007 | 21:15 | 2 051 072 |
| Resolutionobjectmodel.dll                                   | 5.0.5317.0 | 30. ledna 2007 | 21:14 | 1 485 312 |

**Ověření instalace aktualizace**

-   **Nástroj Microsoft Baseline Security Analyzer**

    Pokud chcete ověřit, je-li tato aktualizace zabezpečení v počítači nainstalována, můžete použít nástroj Microsoft Baseline Security Analyzer (MBSA). Další informace naleznete v odpovědi na dotaz „Je možné určit pomocí nástroje MBSA (Microsoft Baseline Security Analyzer), zda je tato aktualizace nezbytná?“ v části Nejčastější dotazy související s touto aktualizací zabezpečení v tomto bulletinu.

-   **Ověření verze souboru**

    **Poznámka:** Vzhledem k různým verzím systému Microsoft Windows se následující postup může lišit od postupu ve vašem počítači. Pokud tomu tak je, bude třeba před dokončením následujících kroků konzultovat dokumentaci k produktu.

    1.  Klepněte na tlačítko **Start** a potom na příkaz **Hledat**.
    2.  Ve skupinovém rámečku **Průvodce vyhledáváním** v podokně **Výsledky hledání** klepněte na odkaz **Všechny soubory a složky**.
    3.  Do pole **Část nebo celý název souboru** zadejte název souboru z příslušné tabulky a klepněte na tlačítko **Hledat**.
    4.  V seznamu souborů klepněte pravým tlačítkem myši na název souboru z příslušné tabulky s informacemi o souborech a klepněte na příkaz **Vlastnosti**.

      **Poznámka:** V závislosti na verzi operačního systému nebo nainstalovaných aplikacích nemusejí být některé soubory uvedené v tabulce s informacemi o souborech nainstalovány.
    5.  Na kartě **Verze** zjistěte verzi souboru nainstalovaného v počítači a porovnejte ji s verzí popsanou v příslušné tabulce s informacemi o souborech.

      **Poznámka:** Atributy (kromě verze souboru) se mohou při instalaci změnit. Porovnání jiných atributů souboru s informacemi v příslušné tabulce není spolehlivou metodou ověření instalace aktualizace. V určitých případech mohou být soubory při instalaci přejmenovány. Pokud soubor nebo informace o verzi nejsou k dispozici, použijte k ověření instalace aktualizace některou jinou metodu.

### Další informace

**Poděkování**

Společnost Microsoft tímto [děkuje](http://go.microsoft.com/fwlink/?linkid=21127) za spolupráci při ochraně zákazníků:

-   Martynu Toveyovi ze společnosti [Netcraft](http://news.netcraft.com/) za oznámení chyby zabezpečení umožňující skriptování mezi servery a umísťování falešného obsahu ve službě Microsoft Content Management – CVE-2007-0939.

**Získání dalších aktualizací zabezpečení:**

Aktualizace odstraňující další problémy se zabezpečením získáte v následujících umístěních:

-   Aktualizace zabezpečení jsou k dispozici na [webu služby Stažení softwaru (Microsoft Download Center)](http://go.microsoft.com/fwlink/?linkid=21129). Nejsnadněji je naleznete hledáním podle klíčového slova oprava\_zabezpečení (security\_patch).
-   Aktualizace pro klientské platformy jsou k dispozici na [webu Microsoft Update](http://go.microsoft.com/fwlink/?linkid=40747).

**Technická podpora:**

-   Zákazníci mohou získat technickou podporu na webu [služby technické podpory společnosti Microsoft](http://go.microsoft.com/fwlink/?linkid=21131). Hovory související s aktualizacemi zabezpečení jsou bezplatné.
-   Mezinárodní zákazníci získají podporu u místních zastoupení společnosti Microsoft. Technická podpora související s aktualizacemi zabezpečení je bezplatná. Další informace o možnostech kontaktování společnosti Microsoft v případě potřeby mezinárodní technické podpory naleznete na webu [mezinárodní technické podpory](http://go.microsoft.com/fwlink/?linkid=21155).

**Zdroje informací o zabezpečení:**

-   Další informace o zabezpečení produktů společnosti Microsoft nabízí web [Microsoft TechNet Security](http://go.microsoft.com/fwlink/?linkid=21132).
-   [TechNet Update Management Center](http://go.microsoft.com/fwlink/?linkid=69903)
-   [Služba Microsoft Software Update Services](http://go.microsoft.com/fwlink/?linkid=21133)
-   [Služba Microsoft Windows Server Update Services](http://go.microsoft.com/fwlink/?linkid=50120)
-   [Nástroj MBSA](http://go.microsoft.com/fwlink/?linkid=21134) (Microsoft Baseline Security Analyzer)
-   [Windows Update](http://go.microsoft.com/fwlink/?linkid=21130)
-   [Microsoft Update](http://update.microsoft.com/microsoftupdate)
-   Katalog systému Windows Update: Další informace o katalogu systému Windows Update získáte v [článku 323166 znalostní báze Microsoft Knowledge Base](http://support.microsoft.com/kb/323166).
-   [Office Update](http://go.microsoft.com/fwlink/?linkid=21135)

**Služba Software Update Services:**

Pomocí služby Microsoft Software Update Services (SUS) mohou správci systémů rychle a spolehlivě instalovat nejnovější důležité aktualizace zabezpečení pro servery se systémem Windows 2000 a Windows Server 2003 i pro stolní počítače se systémem Windows 2000 Professional nebo Windows XP Professional.

Další informace o způsobu nasazení aktualizací zabezpečení pomocí služby SUS získáte na [webu služby Software Update Services](http://go.microsoft.com/fwlink/?linkid=21133).

**Služba Windows Server Update Services:**

Pomocí služby Windows Server Update Services (WSUS) mohou správci systémů rychle a spolehlivě instalovat nejnovější důležité aktualizace zabezpečení pro systémy Windows 2000 a vyšší, sadu Office XP a vyšší, Exchange Server 2003 a SQL Server 2000 do systémů Windows 2000 a novějších.

Další informace o způsobu nasazení aktualizací zabezpečení pomocí služby Windows Server Update Services získáte na [webu služby Windows Server Update Services](http://go.microsoft.com/fwlink/?linkid=50120).

**Systems Management Server:**

Microsoft Systems Management Server (SMS) představuje v rozlehlých sítích řešení pro správu aktualizací s rozsáhlými možnostmi konfigurace. Umožňuje správcům identifikovat počítače se systémem Windows, které vyžadují aktualizace zabezpečení, a provést řízenou instalaci těchto aktualizací v celé rozlehlé síti, a to s minimálním dopadem na koncové uživatele. Další informace o tom, jak mohou správci pomocí serveru SMS 2003 instalovat aktualizace zabezpečení, získáte na webu [SMS 2003 Security Patch Management](http://go.microsoft.com/fwlink/?linkid=22939). Uživatelé serveru SMS 2.0 mohou při instalaci aktualizací zabezpečení použít také sadu [Software Updates Service Feature Pack](http://go.microsoft.com/fwlink/?linkid=33340). Další informace o serveru SMS získáte na [webu serveru SMS](http://go.microsoft.com/fwlink/?linkid=21158).

**Poznámka:** Server SMS využívá nástroj MBSA (Microsoft Baseline Security Analyzer), nástroj pro rozpoznávání sady Microsoft Office a nástroj pro vyhledávání aktualizací v rozlehlých sítích (Enterprise Update Scan Tool – EST), a poskytuje tak podporu pro zjišťování a instalaci aktualizací uvedených v bulletinech zabezpečení. Tyto nástroje nemusí některé softwarové aktualizace zjistit. V takovém případě mohou správci použít funkce serveru SMS a nasměrovat aktualizace do určitých systémů. Další informace o tomto postupu najdete na následujícím [webu](http://go.microsoft.com/fwlink/?linkid=33341). Některé aktualizace zabezpečení vyžadují po restartování počítače oprávnění správce. Správci mohou k instalaci těchto aktualizací použít nástroj Elevated Rights Deployment Tool (k dispozici v sadě [SMS 2003 Administration Feature Pack](http://go.microsoft.com/fwlink/?linkid=33387) a [SMS 2.0 Administration Feature Pack](http://go.microsoft.com/fwlink/?linkid=21161)).

**Zřeknutí se záruky:**

Informace ve znalostní bázi Microsoft Knowledge Base jsou poskytovány tak, jak jsou, bez jakékoli záruky. Společnost Microsoft neposkytuje žádné záruky, výslovně uvedené či mlčky předpokládané, včetně záruk obchodovatelnosti a vhodnosti pro určitý účel. Společnost Microsoft ani její dodavatelé nenesou v žádném případě zodpovědnost za žádné škody, včetně přímých, nepřímých, náhodných či následných škod, ztráty zisku či zvláštních škod, a to ani v případě, že byli na možnost takových škod upozorněni. V některých zemích a právních řádech není dovoleno vyloučit nebo omezit odpovědnost, proto se výše uvedené omezení na vás nemusí vztahovat.

**Revize:**

-   V1.0 (10. dubna 2007): Bulletin byl publikován.
-   V1.1 (1. května 2007): Bulletin byl aktualizován. Upozornění uvedené v [článku 924429 znalostní báze Microsoft Knowledge Base](http://support.microsoft.com/kb/924429) popisuje aktuálně známé problémy se zabezpečením, které mohou zákazníci zaznamenat po instalaci této aktualizace zabezpečení.
-   V2.0 (12. června 2007): Bulletin byl aktualizován: Tento bulletin byl znovu vydán, aby obsahoval informace o odstranění chyb, které byly popsány v [článku 924429 znalostní báze Microsoft Knowledge Base](http://support.microsoft.com/kb/924429).

*Built at 2014-04-18T01:50:00Z-07:00*
